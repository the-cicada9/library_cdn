(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))o(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function i(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerPolicy&&(s.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?s.credentials="include":t.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(t){if(t.ep)return;t.ep=!0;const s=i(t);fetch(t.href,s)}})();function u(n){return new Promise((e,i)=>{const o=document.createElement("script");o.src=n,o.onload=()=>e(n),o.onerror=t=>i(`Error loading script: ${n}`),document.body.appendChild(o)})}async function x(){try{console.log("Loading html2canvas..."),await u("https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"),console.log("html2canvas loaded!"),console.log("Loading Fabric.js..."),await u("https://cdn.jsdelivr.net/npm/fabric@6.4.3/dist/index.js"),console.log("Fabric.js loaded!"),console.log("Loading JSZip..."),await u("https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"),console.log("JSZip loaded!"),C.runSdk()}catch(n){console.error("Error loading scripts:",n)}}x();const C={runSdk(){A(),k()}};let d="",h="";const I="https://bmrtapplicationdev.appskeeper.in/v1/sessions/session",T={appToken:"0f4365b8-a41d-41c3-80d9-b23bc6e2594f",deviceToken:"qwe123"};function k(){const n=document.getElementById("def-camera"),e=document.getElementById("def-img"),i=document.getElementById("def-ui");fetch(I,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(T)}).then(o=>o.json()).then(o=>{const t=o.result.token;console.log(t);const s="https://bmrtapplicationdev.appskeeper.in/v1/issues",l={appInfo:{minSdk:"21",targetSdk:"30",isDebugMode:!0,debuggerAttach:!1,packageId:"com.example.app",locale:"en_US",buildFlavour:"release",versionCode:"123",versionName:"1.2.3"},deviceInfo:{name:"Pixel 4a",manufacturer:"Google",model:"Pixel 4a",deviceId:"12345abcdef",deviceVersion:"Android 12"},platform:{isRooted:!1,os:"iOS"},dimensions:{width:"1080",height:"2340",scale:"3.0",dpi_x:"400",dpi_y:"400",density:"2.75",density_dpi:"420"},type:"bug",email:"user@example.com",accessToken:t,appToken:"0f4365b8-a41d-41c3-80d9-b23bc6e2594f",video:"https://example.com/video.mp4",screenshot:"https://example.com/screenshot.png",shortSummary:"App crashes when clicking the button",description:"The app crashes immediately after clicking the button on the main screen.",trackingSdkVersion:"2.1.0",totalDuration:"5m30s",createdAt:"2024-11-08T10:30:00.000Z",uploadedAt:"2024-11-08T10:33:12.624Z"};return fetch(s,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(l)})}).then(o=>o.json()).then(o=>{console.log("Issue created successfully",o),d=o.result.url,h=o.result.id,console.log(d)}).catch(o=>{console.error("Error:",o)}),n.addEventListener("click",function(){n.textContent==="Capture"?(n.style.visibility="hidden",i.style.backgroundColor="white",html2canvas(document.querySelector("body"),{allowTaint:!0,useCORS:!0,height:window.innerHeight,width:window.innerWidth,x:window.scrollX,y:window.scrollY}).then(o=>{const t=o.toDataURL(),s=g(t);e.src=t,e.style.opacity="1",n.style.visibility="visible",i.style.backgroundColor="black",sendToAPI(s,"")}),n.textContent="Cancel"):n.textContent==="Cancel"&&(e.style.opacity="0",n.textContent="Capture")}),e.addEventListener("click",function(){S(e.src)})}function S(n){const e=document.createElement("div");e.style.position="fixed",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.backgroundColor="rgba(0, 0, 0, 0.8)",e.style.display="flex",e.style.flexDirection="column",e.style.justifyContent="center",e.style.alignItems="center",e.style.zIndex="1000";const i=document.createElement("img");i.src=n,i.style.maxWidth="90%",i.style.maxHeight="80%",i.style.objectFit="contain",i.style.position="absolute";const o=document.createElement("canvas");o.style.position="absolute",o.style.top="0",o.style.left="0",o.style.zIndex="10",e.appendChild(i),e.appendChild(o);const t=document.createElement("button");t.textContent="Submit",t.style.position="absolute",t.style.padding="10px",t.style.backgroundColor="#fff",t.style.border="none",t.style.cursor="pointer",t.style.top="20px",t.style.right="20px",t.style.borderRadius="5px",t.style.zIndex="20",e.appendChild(t);const s=document.createElement("input");s.style.width="50%",s.style.marginTop="50px",s.style.padding="10px",s.style.fontSize="14px",s.style.borderRadius="5px",s.style.border="1px solid #ccc",s.placeholder="Write description...",e.appendChild(s),document.getElementById("canvas-container").appendChild(e);const r=new fabric.Canvas(o);r.isDrawingMode=!0,r.freeDrawingBrush=new fabric.PencilBrush(r),r.freeDrawingBrush.width=5,r.freeDrawingBrush.color="#000000",i.onload=function(){r.setWidth(i.width),r.setHeight(i.height),r.renderAll()},r.on("path:created",function(){const p=r.toDataURL();console.log(p,">>>new")}),t.addEventListener("click",function(){t.style.display="none",html2canvas(e).then(function(p){const f=p.toDataURL("image/png"),b=g(f),v=s.value;console.log(v,">>>desc");const w={metadata:{batteryInfo:[{isCharging:!0,lowPowerMode:!0,batteryPercentage:"75%",capturedAt:"2024-11-08T10:33:12.624Z",duration:"15m"}],network:[{type:"Wi-Fi",status:"connected",rssi:"-60dBm",ssid:"MyWiFiNetwork",bssid:"00:14:22:01:23:45",mcc:"310",mnc:"260",name:"Home Wi-Fi",networkCountryCode:"US",simCountryCode:"US",phoneType:"Smartphone",capturedAt:"2024-11-08T10:33:15.000Z",duration:"5m"}],deviceOrientation:[{value:"portrait",capturedAt:"2024-11-08T10:33:20.000Z",duration:"10m"}],applicationState:[{value:"foreground",capturedAt:"2024-11-08T10:33:25.000Z",duration:"7m"}],multiWindow:[{value:!1,capturedAt:"2024-11-08T10:33:30.000Z",duration:"5m"}],topView:[{value:"com.example.app.MainActivity",capturedAt:"2024-11-08T10:33:35.000Z",duration:"6m"}],cpuUtilization:[{value:"18%",capturedAt:"2024-11-08T10:33:40.000Z",duration:"5m"}],flash:[{capturedAt:"2024-11-08T10:33:45.000Z",memory:"30MB",unit:"MB"}],memory:[{capturedAt:"2024-11-08T10:33:50.000Z",memory:"1.8GB",unit:"GB"}],bluetooth:[{isConnected:!0,name:"Bluetooth Speaker",capturedAt:"2024-11-08T10:33:12.624Z",duration:"15m"}]}};var a=new JSZip;a.folder("BMRTLogs"),a.folder("BMRTLogs").file("snapshot.jpeg",b),a.folder("BMRTLogs").file("meta.json",JSON.stringify(w)),console.log(a,">>> zip object"),console.log(d,"url_for_zip_file"),a.generateAsync({type:"blob"}).then(function(m){console.log(m,">>> generated zip content");const y=new File([m],`issue_${h}.zip`,{type:"application/zip"});console.log(y,">>> created zip file"),fetch(d,{method:"PUT",body:y}).then(c=>c.json()).then(c=>{console.log("API Response:",c),t.style.display="block"}).catch(c=>{console.error("Error uploading ZIP:",c),t.style.display="block"})})})})}function A(){const n=document.createElement("div"),e=document.createElement("button"),i=document.createElement("img"),o=document.createElement("div");i.id="def-img",e.id="def-camera",n.id="def-ui",o.id="canvas-container",e.textContent="Capture",e.style.color="black",e.style.backgroundColor="white",e.style.width="80%",e.style.position="relative",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.cursor="pointer",e.style.zIndex="100",n.style.position="fixed",n.style.bottom="16px",n.style.right="16px",n.style.width="100px",n.style.height="60px",n.style.backgroundColor="black",n.style.borderRadius="10px",n.style.zIndex="100",i.style.position="fixed",i.style.width="20vw",i.style.height="30vh",i.style.objectFit="contain",i.style.right="16px",i.style.bottom="80px",i.style.opacity="0",i.style.background="red",i.style.zIndex="100",o.style.position="absolute",o.style.top="0",o.style.left="0",o.style.width="100%",o.style.height="100%",o.style.zIndex="10",document.body.appendChild(o),document.body.appendChild(n),n.appendChild(e),document.body.appendChild(i)}function g(n){const e=atob(n.split(",")[1]),i=new Uint8Array(e.length);for(let t=0;t<e.length;t++)i[t]=e.charCodeAt(t);const o=n.split(";")[0].split(":")[1];return new Blob([i],{type:o})}
